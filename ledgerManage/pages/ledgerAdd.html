<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="../static/libs/webuploader/webuploader.css">
    </head>
    <body>
        <div class="infor">
<!--                   合同相关信息-->
            <div class="heton-infor">
                合同&项目信息
                <span class="tools">
                    <span class="tools-btn" data-toggle="modal">提交</span>
                </span>
            </div>
            <div class="heton-container">
                <table class="heton" border="0">
                    <tbody>
                        <tr>
                            <td class="col-1">
                                <div>
                                    <span>合同编号</span>
                                </div>
                            </td>
                            <td class="col-2">
                                <input type="text" value="" id="only" data-toggle="important" data-target="input" disabled>
                                <span data-show="bitian" class="mustBe">*必填</span>
                            </td>
                            <td class="col-1">
                                <div>
                                    <span>合同签订日期</span>
                                </div>
                            </td>
                            <td class="col-2">
                                <input type="text" value="" data-target="input" class="form_datetime" readonly>
                                <span data-show="bitian" class="mustBe">*必填</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="col-1">
                                <div>
                                    <span>项目名称</span>
                                </div>
                            </td>
                            <td class="col-2">
                                <input type="text" value="绿能宝大庆项目" data-target="input">
                                <span data-show="bitian" class="mustBe">*必填</span>
                            </td>
                            <td class="col-1">
                                <div>
                                    <span>项目类别</span>
                                </div>
                            </td>
                            <td class="col-2">
                                <input type="text" value="" data-target="input">
                                <span data-show="bitian" class="mustBe">*必填</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="col-1">
                                <div>
                                    <span>技术协议签订时间</span>
                                </div>
                            </td>
                            <td class="col-2">
                                <input type="text" value="" data-target="input" class="form_datetime" readonly>
                                <span data-show="bitian" class="mustBe">*必填</span>
                            </td>
                            <td class="col-1">
                                <div>
                                    <span>并网时间</span>
                                </div>
                            </td>
                            <td class="col-2">
                                <input type="text" value="" data-target="input" class="form_datetime" readonly disabled>
                                <span data-show="bitian" class="mustBe">*必填</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="col-1">
                                <div>
                                    <span>总金额</span>
                                </div>
                            </td>
                            <td class="col-2">
                                <input type="text" value="" class="allMon isNum" data-target="input">
                                <span data-show="bitian" class="mustBe">*必填</span>
                            </td>
                            <td class="col-1">
                                <div>
                                    <span>支付方式</span>
                                </div>
                            </td>
                            <td class="col-2">
                                <select name=""  style="height:30px;width:72%;border:1" data-target="input" disabled>
                                      <option value=""></option>
                                      <option value="">电汇</option>
                                      <option value="">承兑</option>
                                      <option value="">电汇和承兑</option>
                                </select>
                                <span data-show="bitian" class="mustBe">*必填</span>
                            </td>
                        </tr>
                         <tr>
                            <td class="col-1">
                                <div>
                                    <span>币种</span>
                                </div>
                            </td>
                            <td class="col-2">
                                <select name="" id="sele" style="height:30px;width:72%;border:1" data-target="input">
                                      <option value=""></option>
                                      <option value="">人民币</option>
                                      <option value="">美元</option>
                                </select>
                                <span data-show="bitian" class="mustBe">*必填</span>
                            </td>
                            <td class="col-1">
                                <div>
                                    <span>税率</span>
                                </div>
                            </td>
                            <td class="col-2">
                                <select name=""  style="height:30px;width:72%;border:1" data-target="input">
                                      <option value=""></option>
                                      <option value="">17%</option>
                                      <option value="">6%</option>
                                </select>
                                <span data-show="bitian" class="mustBe">*必填</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="col-1">
                                <div>
                                    <span>合同变更情况</span>
                                </div>
                            </td>
                            <td colspan="3">
                                <input class="textArea" type="text">
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
<!--                采购相关信息-->
            <div class="purchase-infor">
                采购相关信息
            </div>
            <div class="purchase-container">
                 <table class="purchase" border="0">
                    <tbody>
                        <tr>
                            <td class="col-1">
                                <div>
                                    <span>采购单位</span>
                                </div>
                            </td>
                            <td class="col-2">
                                <select name=""  style="height:30px;width:72%;border:1" data-target="input">
                                      <option value=""></option>
                                      <option value="">新维智能电力（苏州）有限公司</option>
                                      <option value="">新维太阳能电力工程（苏州）有限公司</option>
                                      <option value="">新余新维新能源有限公司</option>
                                </select>
                                <span data-show="bitian" class="mustBe">*必填</span>
                            </td>
                            <td class="col-1">
                                <div>
                                    <span>供应单位</span>
                                </div>
                            </td>
                            <td class="col-2">
                                <input type="text" value="" data-target="input">
                                <span data-show="bitian" class="mustBe">*必填</span>
                            </td>
                        </tr>

                         <tr>
                              <td colspan="4" >
                                  <table class="inner-table" border="1">
                                        <thead>
                                            <tr>
                                                <th >序号</th>
                                                <th >标的物名称</th>
                                                <th >规格</th>
                                                <th >数量</th>
                                                <th >单位</th>
                                                <th >单价</th>
                                                <th >总金额</th>
                                                <th >操作</th>
                                            </tr>
                                        </thead>
                                        <tbody id="addTab">

                                        </tbody>

                                  </table>

                                    <div class="addTr" id="addTr">
                                        <i class="iconfont icon-tianjia popover-hide"  title="添加一行" data-container="body" data-toggle="popover" data-placement="top"></i>
                                    </div>
                              </td>
                        </tr>

                    </tbody>
                </table>

            </div>
<!--                   付款相关信息 -->
            <div class="pay-infor">
                付款信息
            </div>
            <div class="pay-container">
                <table class="fukuan" border="1">
                    <thead>
                        <tr class="th_title">
                            <th >付款内容</th>
                            <th >百分比(%)</th>
                            <th >付款申请时间</th>
                            <th >申请金额</th>
                            <th >实际付款金额</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="tr_item">
                            <td>
                                <input type="text" value="预付款" readonly>
                            </td>
                            <td>
                                <input type="text" value="" class="percent">
                            </td>
                            <td>
                                <input type="text" value="" class="form_datetime" readonly>
                            </td>
                            <td>
                                <input type="text" value="" class="preMon" readonly >
                            </td>
                            <td>
                                <input type="text" value="0" class="trueMon" readonly>
                            </td>                                    
                        </tr>
                        <tr class="tr_item">
                            <td>
                                <input type="text" value="到货款" readonly>
                            </td>
                           <td>
                                <input type="text" value="" class="percent">
                            </td>
                            <td>
                                <input type="text" value="" class="form_datetime" readonly>
                            </td>
                            <td>
                                <input type="text" value="" class="preMon" readonly >
                            </td>
                            <td>
                                <input type="text" value="0" class="trueMon" readonly >
                            </td>

                        </tr>
                        <tr class="tr_item">
                            <td>
                                <input type="text" value="账期款" readonly>
                            </td>
                           <td>
                                <input type="text" value="" class="percent">
                            </td>
                            <td>
                                <input type="text" value="" class="form_datetime" readonly>
                            </td>
                            <td>
                                <input type="text" value="" class="preMon" readonly >
                            </td>
                            <td>
                                <input type="text" value="0" class="trueMon" readonly >
                            </td>
                        </tr>
                        <tr class="tr_item">
                            <td>
                                <input type="text" value="质保金" readonly>
                            </td>
                            <td>
                                <input type="text" value="" class="percent">
                            </td>
                            <td>
                                <input type="text" value="" class="form_datetime" readonly>
                            </td>
                            <td>
                                <input type="text" value="" class="preMon" readonly >
                            </td>
                            <td>
                                <input type="text" value="0" class="trueMon" readonly >
                            </td>                                    
                        </tr>
                    </tbody>
                </table>
                <div class="totalMonBox">
                    <div class="totalMon">
                        <span>已付合计：<input type="text" class='overMon' value="100" readonly></span>
                        <span>未付合计：<input type="text" class='nonMon' value="100" style="color:#f00" readonly></span>
                        <span>逾期金额：<input type="text" class='exceMon' value="100" style="color:#f59c15" readonly></span>
                    </div>
                </div>
            </div>
            <div class="actualpay-container">
                <table class="actualfukuan" border="1">
                    <thead>
                        <tr class="th_title">
                            <th >付款内容</th>
                            <th >付款次数</th>
                            <th >实际付款时间</th>
                            <th >实际付款金额</th>
                            <th >付款方式</th>
                            <th >备注</th>
                            <th >操作</th>
                        </tr>
                    </thead>
                    <tbody id="addTabTwo">                               
                    </tbody>
                </table>
                <div class="addTrTwo" id="addTrTwo">
                    <i class="iconfont icon-tianjia popover-hide"  title="添加一行" data-container="body" data-toggle="popover" data-placement="top"></i>
                </div> 
            </div>
<!--                   发货相关信息 -->
            <div class="fahuo-infor">
                发货信息
            </div>
            <div class="pay-container">
                <div class="actualpay-container">
                    <table class="actualfukuan" border="1">
                        <thead>
                            <tr class="th_title">
                                <th>预计到货时间</th>
                                <th>运输方式</th>
                                <th>发货时间</th>
                                <th>到货时间</th>
                                <th>发货相关备注</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="addTabThree">
                        </tbody>
                    </table>
                    <div class="addTrTwo" id="addTrThree">
                        <i class="iconfont icon-tianjia popover-hide"  title="添加一行" data-container="body" data-toggle="popover" data-placement="top"></i>
                    </div> 
                </div>
            </div>
<!--               发票信息-->
            <div class="fahuo-infor">
                发票信息
            </div>
            <div class="pay-container">
                <div class="actualpay-container">
                    <table class="actualfukuan" border="1">
                        <thead>
                            <tr class="th_title">
                                <th>发票时间</th>
                                <th>发票号码</th>
                                <th>发票金额</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="addTabFour">
                        </tbody>
                    </table>
                    <div class="addTrTwo" id="addTrFour">
                        <i class="iconfont icon-tianjia popover-hide"  title="添加一行" data-container="body" data-toggle="popover" data-placement="top"></i>
                    </div> 
                </div>
            </div>
<!--            文件上传相关-->
            <div class="fileUpContainer">
                <div class="fileUpLoad">
                    <div class="technologe-document">
                        采购申请单 
                    </div>
                    <div class="uploaderContainer">  
                    <!--用来存放item-->  
                        <div id="buyList" class="uploader-list"></div>  
                        <span class="uploaderBox">  
                            <span id="buyPicker" class="choseFile">选择文件</span>  
                            <a href="javascript:void(0);" class="ctlBtn">开始上传</a>  
                        </span>  
                    </div>  
                </div>
                <div class="fileUpLoad">
                    <div class="technologe-document">
                        比价文件
                    </div>
                    <div class="uploaderContainer">  
                    <!--用来存放item-->  
                        <div id="compareList" class="uploader-list"></div>  
                        <span class="uploaderBox">  
                            <span id="comparePicker" class="choseFile">选择文件</span>  
                            <a href="javascript:void(0);" class="ctlBtn">开始上传</a>  
                        </span>  
                    </div>  
                </div>
                <div class="fileUpLoad">
                    <div class="technologe-document">
                        合同及附件
                    </div>
                    <div class="uploaderContainer">  
                    <!--用来存放item-->  
                        <div id="contactList" class="uploader-list"></div>  
                        <span class="uploaderBox">  
                            <span id="contactPicker" class="choseFile">选择文件</span>  
                            <a href="javascript:void(0);" class="ctlBtn">开始上传</a>  
                        </span>  
                    </div>  
                </div>
                <div class="fileUpLoad">
                    <div class="technologe-document">
                        付款申请单
                    </div>
                    <div class="uploaderContainer">  
                    <!--用来存放item-->  
                        <div id="payList" class="uploader-list"></div>  
                        <span class="uploaderBox">  
                            <span id="payPicker" class="choseFile">选择文件</span>  
                            <a href="javascript:void(0);" id="payBtn" class="ctlBtn">开始上传</a>  
                        </span>  
                    </div>  
                </div>
                 <div class="fileUpLoad">
                    <div class="technologe-document">
                        其他文件
                    </div>
                    <div class="downLoadContent">
                       <span class="downFile">采购申请单①</span>
                       <a href="javascript:base.a();" class="downBtn">下载</a>
                       <a href="javascript:void(0);" class="delBtn">删除</a>
                    </div>
                    <div class="downLoadContent">
                       <span class="downFile">采购申请单①</span>
                       <a href="javascript:void(0);" class="downBtn">下载</a>
                       <a href="javascript:void(0);" class="delBtn">删除</a>
                    </div>
                    <div class="downLoadContent">
                       <span class="downFile">采购申请单①</span>
                       <a href="javascript:void(0);" class="downBtn">下载</a>
                       <a href="javascript:void(0);" class="delBtn">删除</a>
                       <span class="tips">123456</span>
                    </div>
                </div>
            </div>            
        </div> <!--infor-->

<!-- 提交模态框（Modal） -->
       <div class="modal fade bs-example-modal-sm" id="tijiao" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-sm">
                <div class="modal-content model-radius" >
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            &times;
                        </button>
                        <h4 class="modal-title" id="myModalLabel">提交确认</h4>
                    </div>
                    <div class="modal-body">
                        <p>提交前，请确认必填项都已填完整</p>
                        <p>确定提交吗?</p>
                    </div>
                    <div class="modal-footer">
                        <span class="cancle" data-dismiss="modal">取消</span>
                        <span class="sure" data-dismiss="modal">确定</span>
                    </div>
                </div>
            </div>
        </div>
        
<!--        提交成功模态框-->
        <div class="modal fade bs-example-modal-sm" id="submitSuccess" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-sm">
                <div class="modal-content model-radius" >
                    <p class="successTip">提交成功！</p>
                    <span class="Sure" data-dismiss="modal">确定</span>
                </div>
            </div>
        </div>

        <script type="text/javascript" src="../static/js/timepicker.js"></script>
        <script type="text/javascript" src="../static/libs/webuploader/webuploader.js"></script>
        <script>
            var n=0;
            var uploadMethod = function(picker,list){
                //文件上传插件初始化
                n++;
                var uploader = WebUploader.create({    
                       auto: false,// 选完文件后，是否自动上传。              
                       swf: '../statics/libs/webuploader/Uploader.swf',// swf文件路径
                       server: 'http://61.155.204.109:8080/solar-ledger/purchase/up', // 文件接收服务端   
                       // 内部根据当前运行是创建，可能是input元素，也可能是flash.  
                       pick: picker, 
                       // 只允许选择图片文件。  
                       method:'POST',  
                });
                   // 当有文件添加进来的时候  
                uploader.on( 'fileQueued', function( file ) {  // webuploader事件.当选择文件后，文件被加载到文件队列中，触发该事件  
                    var $li = $('<div id="' + file.id + '" class="item">' + '<span class="info">' + file.name + '</span>' + '<span class="state">等待上传...</span>' + '<span class="delete">X</span></div>');//创建文件列表 
                    list.append( $li );
                });  
                 // 文件上传成功，给item添加成功class, 用样式标记上传成功。  
                uploader.on( 'uploadSuccess', function( file ) {
                    $( '#'+file.id ).find('span.state').text('已上传').css('color','#0f0');
                });
                 // 文件上传失败，显示上传出错。  
                uploader.on( 'uploadError', function( file ) {
                    $( '#'+file.id ).find('span.state').text('上传出错').css('color','#f00');
                });
                return uploader;
            }              
                
                var up1 = uploadMethod();
            
            $(function(){
                var up1 = uploadMethod('#buyPicker',$('#buyList'));
                var up2 = uploadMethod('#comparePicker',$('#compareList'));
                var up3 = uploadMethod('#contactPicker',$('#contactList'));
                var up4 = uploadMethod('#payPicker',$('#payList'));
                var up5 = uploadMethod('#otherPicker',$('#otherList'));
                
                $(document).on("click",'#otherBtn',function(){
                    var Idarr = [];
                    var List=$(this).parents('.uploaderContainer').find('.item');
                    for(var i=0;i<List.size();i++){
                        Idarr.push($(List[i]).attr("id"));
                        up5.upload(Idarr[i]);
                    }                                        
                    $(this).css({'color':'#fff','text-decoration':'none'})
                })
            
                $(document).on("click",'#payBtn',function(){
                    var Idarr = []; List=$(this).parents('.uploaderContainer').find('.item');
                    for(var i=0;i<List.size();i++){
                        Idarr.push($(List[i]).attr("id"));
                        up4.upload(Idarr[i]);
                    }                                        
                    $(this).css({'color':'#fff','text-decoration':'none'})
                })
                
                var upArr = [up1,up2,up3,up4,up5]
                for(var i=1;i<6;i++){
                    $(document).on("click",".delete",function(){
                        $(this).parents(".item").remove();
                        var fileid=$(this).parents(".item").attr("id");
                        upArr[i-1].removeFile(uploader.getFile(fileid));
                    });
                }
                
                $(document).on('click','.sure',function(){
                    $('#submitSuccess').modal({
                        backdrop:"static",
                        keyboard:false,
                    });                 
                })
                
                $(document).on('mouseover','.downFile',function(e){
                    var left = $(this).offset().left+100;
                    $(this).parents('.downLoadContent').children('.tips').css({'left':left,'display':'inline-block'});
                })
                $(document).on('mouseout','.downFile',function(){
                    $(this).parents('.downLoadContent').children('.tips').css('display','none');
                })
            })          
            
            
        </script>
    </body>
</html>